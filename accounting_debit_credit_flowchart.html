            <!-- 學習統計 -->
            <div id="statisticsMode" class="exam-mode" style="display: none;">
                <h3>📊 學習統計分析</h3>
                <div id="statisticsContent" class="statistics-content"></div>
            </div>
        </div>
        
        <div class="example-section">
            <h2>💡 實務範例</h2>
            <div class="examples">
                <div class="example-card">
                    <h3>🏦 資產範例</h3>
                    <div class="example-item">
                        <strong>現金增加 $10,000</strong><br>
                        → 借：現金 $10,000
                    </div>
                    <div class="example-item">
                        <strong>支付現金 $5,000</strong><br>
                        → 貸：現金 $5,000
                    </div>
                </div>
                
                <div class="example-card">
                    <h3>💳 負債範例</h3>
                    <div class="example-item">
                        <strong>賒購商品 $8,000</strong><br>
                        → 貸：應付帳款 $8,000
                    </div>
                    <div class="example-item">
                        <strong>償還應付帳款 $3,000</strong><br>
                        → 借：應付帳款 $3,000
                    </div>
                </div>
                
                <div class="example-card">
                    <h3>💰 收入範例</h3>
                    <div class="example-item">
                        <strong>銷售商品收入 $15,000</strong><br>
                        → 貸：銷貨收入 $15,000
                    </div>
                    <div class="example-item">
                        <strong>銷貨退回 $2,000</strong><br>
                        → 借：銷貨收入 $2,000
                    </div>
                </div>
                
                <div class="example-card">
                    <h3>💼 費用範例</h3>
                    <div class="example-item">
                        <strong>支付薪資 $12,000</strong><br>
                        → 借：薪資費用 $12,000
                    </div>
                    <div class="example-item">
                        <strong>費用沖回 $1,000</strong><br>
                        → 貸：薪資費用 $1,000
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全域變數
        let currentQuestion = 0;
        let examQuestions = [];
        let userAnswers = [];
        let examTimer = null;
        let examStartTime = null;
        let examStats = JSON.parse(localStorage.getItem('examStats')) || {
            totalQuestions: 0,
            correctAnswers: 0,
            totalExams: 0,
            timeSpent: 0,
            wrongQuestions: []
        };

        // 題庫
        const questionBank = {
            beginner: [
                {
                    question: "現金增加 $50,000 時，應該如何記帳？",
                    scenario: "公司收到客戶付款 $50,000",
                    options: ["借：現金 $50,000", "貸：現金 $50,000", "借：銀行存款 $50,000", "貸：銀行存款 $50,000"],
                    correct: 0,
                    explanation: "現金是資產科目，增加時記借方。資產增加記借方是會計的基本原則。",
                    type: "asset",
                    level: "beginner"
                },
                {
                    question: "支付租金費用 $10,000 時，租金費用應該記在哪一方？",
                    scenario: "公司支付本月辦公室租金 $10,000",
                    options: ["借：租金費用 $10,000", "貸：租金費用 $10,000", "借：預付費用 $10,000", "貸：應付費用 $10,000"],
                    correct: 0,
                    explanation: "租金費用屬於費用科目，費用發生（增加）時記借方。",
                    type: "expense",
                    level: "beginner"
                },
                {
                    question: "公司向銀行借款 $100,000 時，借款應該記在哪一方？",
                    scenario: "公司向銀行申請短期借款 $100,000",
                    options: ["借：短期借款 $100,000", "貸：短期借款 $100,000", "借：長期借款 $100,000", "貸：應收帳款 $100,000"],
                    correct: 1,
                    explanation: "短期借款屬於負債科目，負債增加時記貸方。",
                    type: "liability",
                    level: "beginner"
                },
                {
                    question: "銷售商品獲得收入 $80,000 時，銷貨收入應該記在哪一方？",
                    scenario: "公司銷售商品給客戶，收入 $80,000",
                    options: ["借：銷貨收入 $80,000", "貸：銷貨收入 $80,000", "借：應收帳款 $80,000", "貸：存貨 $80,000"],
                    correct: 1,
                    explanation: "銷貨收入屬於收入科目，收入發生（增加）時記貸方。",
                    type: "revenue",
                    level: "beginner"
                },
                {
                    question: "償還應付帳款 $30,000 時，應付帳款應該記在哪一方？",
                    scenario: "公司償還供應商款項 $30,000",
                    options: ["借：應付帳款 $30,000", "貸：應付帳款 $30,000", "借：應收帳款 $30,000", "貸：現金 $30,000"],
                    correct: 0,
                    explanation: "應付帳款屬於負債科目，負債減少時記借方。",
                    type: "liability",
                    level: "beginner"
                }
            ],
            intermediate: [
                {
                    question: "賒購商品 $60,000，商品和應付帳款分別如何記帳？",
                    scenario: "公司向供應商賒購商品 $60,000，30天後付款",
                    options: ["借：商品存貨 $60,000，貸：應付帳款 $60,000", "貸：商品存貨 $60,000，借：應付帳款 $60,000", "借：應付帳款 $60,000，貸：商品存貨 $60,000", "借：進貨 $60,000，借：應付帳款 $60,000"],
                    correct: 0,
                    explanation: "賒購時，存貨（資產）增加記借方，應付帳款（負債）增加記貸方。這是複式記帳的典型例子。",
                    type: "mixed",
                    level: "intermediate"
                },
                {
                    question: "收到預付款 $25,000 時，預收款項應該記在哪一方？",
                    scenario: "客戶預付購貨款 $25,000，商品將於下月交付",
                    options: ["借：預收款項 $25,000", "貸：預收款項 $25,000", "借：銷貨收入 $25,000", "貸：應收帳款 $25,000"],
                    correct: 1,
                    explanation: "預收款項屬於負債科目（因為公司有義務提供商品或服務），負債增加記貸方。",
                    type: "liability",
                    level: "intermediate"
                },
                {
                    question: "購買設備 $150,000 以現金支付時，設備和現金分別如何記帳？",
                    scenario: "公司購買生產設備 $150,000，以現金支付",
                    options: ["借：設備 $150,000，貸：現金 $150,000", "貸：設備 $150,000，借：現金 $150,000", "借：費用 $150,000，貸：現金 $150,000", "借：設備 $150,000，借：現金 $150,000"],
                    correct: 0,
                    explanation: "設備（資產）增加記借方，現金（資產）減少記貸方。這是資產間的轉換。",
                    type: "asset",
                    level: "intermediate"
                },
                {
                    question: "發生銷貨退回 $15,000 時，銷貨收入應該如何調整？",
                    scenario: "客戶退回瑕疵商品，退回金額 $15,000",
                    options: ["借：銷貨收入 $15,000", "貸：銷貨收入 $15,000", "借：銷貨退回 $15,000", "貸：銷貨成本 $15,000"],
                    correct: 0,
                    explanation: "銷貨退回時，銷貨收入減少，收入減少時記借方（相反方向）。",
                    type: "revenue",
                    level: "intermediate"
                }
            ],
            advanced: [
                {
                    question: "公司發行股票籌資 $500,000，股本和現金分別如何記帳？",
                    scenario: "公司發行普通股籌集資金 $500,000，每股面額 $10，發行 50,000 股",
                    options: ["借：現金 $500,000，貸：股本 $500,000", "貸：現金 $500,000，借：股本 $500,000", "借：股本 $500,000，貸：現金 $500,000", "借：現金 $500,000，借：股本 $500,000"],
                    correct: 0,
                    explanation: "發行股票時，現金（資產）增加記借方，股本（權益）增加記貸方。",
                    type: "equity",
                    level: "advanced"
                },
                {
                    question: "計提折舊費用 $20,000 時，折舊費用和累計折舊分別如何記帳？",
                    scenario: "月底計提設備折舊費用 $20,000",
                    options: ["借：折舊費用 $20,000，貸：累計折舊 $20,000", "貸：折舊費用 $20,000，借：累計折舊 $20,000", "借：累計折舊 $20,000，貸：折舊費用 $20,000", "借：折舊費用 $20,000，貸：設備 $20,000"],
                    correct: 0,
                    explanation: "折舊費用（費用）增加記借方，累計折舊（資產抵銷科目）增加記貸方。",
                    type: "expense",
                    level: "advanced"
                },
                {
                    question: "計提壞帳費用 $8,000 時，壞帳費用和備抵壞帳分別如何記帳？",
                    scenario: "依據應收帳款餘額的 2% 計提壞帳準備 $8,000",
                    options: ["借：壞帳費用 $8,000，貸：備抵壞帳 $8,000", "貸：壞帳費用 $8,000，借：備抵壞帳 $8,000", "借：備抵壞帳 $8,000，貸：壞帳費用 $8,000", "借：壞帳費用 $8,000，貸：應收帳款 $8,000"],
                    correct: 0,
                    explanation: "壞帳費用（費用）增加記借方，備抵壞帳（資產抵銷科目）增加記貸方。",
                    type: "expense",
                    level: "advanced"
                },
                {
                    question: "收到投資收益 $12,000 時，現金和投資收益分別如何記帳？",
                    scenario: "公司持有的股票投資收到現金股利 $12,000",
                    options: ["借：現金 $12,000，貸：投資收益 $12,000", "貸：現金 $12,000，借：投資收益 $12,000", "借：投資收益 $12,000，貸：現金 $12,000", "借：現金 $12,000，借：投資收益 $12,000"],
                    correct: 0,
                    explanation: "現金（資產）增加記借方，投資收益（收入）增加記貸方。",
                    type: "revenue",
                    level: "advanced"
                },
                {
                    question: "預付保險費 $36,000（一年期）時，預付費用和現金分別如何記帳？",
                    scenario: "公司預付一年期的財產保險費 $36,000",
                    options: ["借：預付費用 $36,000，貸：現金 $36,000", "貸：預付費用 $36,000，借：現金 $36,000", "借：保險費用 $36,000，貸：現金 $36,000", "借：現金 $36,000，貸：預付費用 $36,000"],
                    correct: 0,
                    explanation: "預付費用（資產）增加記借方，現金（資產）減少記貸方。預付費用是未來期間的費用，目前仍為資產。",
                    type: "asset",
                    level: "advanced"
                }
            ]
        };

        // 基本功能
        function calculateDebitCredit() {
            const accountType = document.getElementById('accountType').value;
            const change = document.getElementById('change').value;
            const resultDiv = document.getElementById('demoResult');
            
            if (!accountType || !change) {
                alert('請選擇科目類型和變化方向！');
                return;
            }
            
            const rules = {
                asset: { increase: '借', decrease: '貸', name: '資產' },
                liability: { increase: '貸', decrease: '借', name: '負債' },
                equity: { increase: '貸', decrease: '借', name: '權益' },
                revenue: { increase: '貸', decrease: '借', name: '收入' },
                expense: { increase: '借', decrease: '貸', name: '費用' }
            };
            
            const changeText = change === 'increase' ? '增加' : '減少';
            const result = rules[accountType][change];
            const accountName = rules[accountType].name;
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div style="font-size: 1.5em; margin-bottom: 10px;">
                    📊 ${accountName} ${changeText} → <span style="color: ${result === '借' ? '#c62828' : '#2e7d32'}; font-size: 1.2em;">${result}方</span>
                </div>
                <div style="font-size: 1em; color: #666;">
                    記憶：${accountName}${change === 'increase' ? '多' : '少'}${result}
                </div>
            `;
        }

        // 考試功能
        function showExamMode(mode) {
            // 隱藏所有模式
            document.querySelectorAll('.exam-mode').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.exam-tab').forEach(el => el.classList.remove('active'));
            
            // 顯示選中的模式
            document.getElementById(mode + 'Mode').style.display = 'block';
            
            // 找到被點擊的標籤並標記為活動
            const clickedTab = Array.from(document.querySelectorAll('.exam-tab')).find(tab => 
                tab.textContent.includes(getTabText(mode))
            );
            if (clickedTab) {
                clickedTab.classList.add('active');
            }
            
            // 特殊處理
            if (mode === 'review') {
                updateReviewContent();
            } else if (mode === 'statistics') {
                updateStatistics();
            }
        }

        function getTabText(mode) {
            const tabTexts = {
                'practice': '練習模式',
                'test': '正式考試',
                'review': '錯題回顧',
                'statistics': '學習統計'
            };
            return tabTexts[mode] || '';
        }

        function showStatistics() {
            showExamMode('statistics');
        }

        function startPractice() {
            const level = document.getElementById('practiceLevel').value;
            const questions = questionBank[level];
            
            if (!questions || questions.length === 0) {
                alert('該難度等級暫無題目！');
                return;
            }
            
            const randomQuestion = questions[Math.floor(Math.random() * questions.length)];
            displayQuestion(randomQuestion, 'practice');
        }

        function startExam() {
            const duration = parseInt(document.getElementById('testDuration').value);
            const count = parseInt(document.getElementById('questionCount').value);
            const level = document.getElementById('testLevel').value;
            
            // 生成考試題目
            examQuestions = generateExamQuestions(level, count);
            
            if (examQuestions.length === 0) {
                alert('無法生成足夠的題目，請調整設定！');
                return;
            }
            
            userAnswers = [];
            currentQuestion = 0;
            
            // 開始計時
            examStartTime = Date.now();
            startExamTimer(duration);
            
            // 顯示考試進度
            document.getElementById('examProgress').style.display = 'block';
            document.querySelector('.exam-settings').style.display = 'none';
            
            // 顯示第一題
            displayExamQuestion();
        }

        function generateExamQuestions(level, count) {
            let questions = [];
            
            if (level === 'mixed') {
                const allQuestions = [...questionBank.beginner, ...questionBank.intermediate, ...questionBank.advanced];
                questions = shuffleArray([...allQuestions]);
            } else {
                questions = shuffleArray([...questionBank[level]]);
            }
            
            return questions.slice(0, Math.min(count, questions.length));
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function startExamTimer(duration) {
            let timeLeft = duration;
            
            examTimer = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                const timerElement = document.getElementById('examTimer');
                if (timerElement) {
                    timerElement.textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
                
                if (timeLeft <= 0) {
                    clearInterval(examTimer);
                    finishExam();
                }
            }, 1000);
        }

        function displayQuestion(question, mode) {
            const containerId = mode === 'practice' ? 'practiceQuestion' : 'examQuestion';
            const container = document.getElementById(containerId);
            
            if (!container) {
                console.error('找不到容器:', containerId);
                return;
            }
            
            container.style.display = 'block';
            container.innerHTML = `
                <div class="question-text">${question.question}</div>
                ${question.scenario ? `<div class="question-scenario">💼 情境：${question.scenario}</div>` : ''}
                <div class="answer-options" id="${mode}Options">
                    ${question.options.map((option, index) => 
                        `<div class="answer-option" onclick="selectAnswer(${index}, '${mode}')" id="${mode}Option${index}">
                            ${option}
                        </div>`
                    ).join('')}
                </div>
                <div class="question-buttons">
                    <button class="submit-btn" onclick="submitAnswer('${mode}')">提交答案</button>
                    ${mode === 'practice' ? '<button class="next-btn" onclick="startPractice()">下一題</button>' : ''}
                    ${mode === 'exam' ? '<button class="skip-btn" onclick="skipQuestion()">跳過</button>' : ''}
                </div>
                <div id="${mode}Explanation" class="explanation" style="display: none;">
                    <h4>📚 解析</h4>
                    <p>${question.explanation}</p>
                </div>
            `;
            
            // 儲存當前題目
            if (mode === 'practice') {
                window.currentPracticeQuestion = question;
            }
        }

        function displayExamQuestion() {
            if (currentQuestion >= examQuestions.length) {
                finishExam();
                return;
            }
            
            const question = examQuestions[currentQuestion];
            
            // 更新進度
            const questionCounter = document.getElementById('questionCounter');
            const progressBar = document.getElementById('progressBar');
            const currentScore = document.getElementById('currentScore');
            
            if (questionCounter) {
                questionCounter.textContent = `第 ${currentQuestion + 1} 題，共 ${examQuestions.length} 題`;
            }
            
            if (progressBar) {
                progressBar.style.width = `${((currentQuestion) / examQuestions.length) * 100}%`;
            }
            
            if (currentScore) {
                const correctAnswers = userAnswers.filter(a => a.correct).length;
                currentScore.textContent = `目前得分: ${correctAnswers}/${currentQuestion}`;
            }
            
            displayQuestion(question, 'exam');
        }

        function selectAnswer(index, mode) {
            // 清除所有選項的選中狀態
            const options = document.querySelectorAll(`#${mode}Options .answer-option`);
            options.forEach(el => el.classList.remove('selected'));
            
            // 標記選中的選項
            const selectedOption = document.getElementById(`${mode}Option${index}`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
            }
            
            // 儲存選擇
            if (mode === 'practice') {
                window.selectedPracticeAnswer = index;
            } else if (mode === 'exam') {
                window.selectedExamAnswer = index;
            }
        }

        function submitAnswer(mode) {
            let selectedAnswer, currentQ, explanationId;
            
            if (mode === 'practice') {
                selectedAnswer = window.selectedPracticeAnswer;
                currentQ = window.currentPracticeQuestion;
                explanationId = 'practiceExplanation';
            } else if (mode === 'exam') {
                selectedAnswer = window.selectedExamAnswer;
                currentQ = examQuestions[currentQuestion];
                explanationId = 'examExplanation';
            }
            
            if (selectedAnswer === undefined || !currentQ) {
                alert('請先選擇一個答案！');
                return;
            }
            
            const isCorrect = selectedAnswer === currentQ.correct;
            
            // 顯示答案結果
            const options = document.querySelectorAll(`#${mode}Options .answer-option`);
            options.forEach((el, index) => {
                el.style.pointerEvents = 'none';
                if (index === currentQ.correct) {
                    el.classList.add('correct');
                } else if (index === selectedAnswer && !isCorrect) {
                    el.classList.add('wrong');
                }
            });
            
            // 顯示解析
            const explanationElement = document.getElementById(explanationId);
            if (explanationElement) {
                explanationElement.style.display = 'block';
            }
            
            // 更新統計
            examStats.totalQuestions++;
            if (isCorrect) {
                examStats.correctAnswers++;
            } else {
                // 記錄錯題
                examStats.wrongQuestions.push({
                    question: currentQ.question,
                    scenario: currentQ.scenario || '',
                    yourAnswer: currentQ.options[selectedAnswer],
                    correctAnswer: currentQ.options[currentQ.correct],
                    explanation: currentQ.explanation,
                    timestamp: new Date().toLocaleString()
                });
            }
            
            // 考試模式特殊處理
            if (mode === 'exam') {
                userAnswers.push({
                    questionIndex: currentQuestion,
                    selectedAnswer: selectedAnswer,
                    correct: isCorrect,
                    question: currentQ
                });
                
                // 延遲顯示下一題按鈕
                setTimeout(() => {
                    const buttonContainer = document.querySelector('.question-buttons');
                    if (buttonContainer) {
                        if (currentQuestion < examQuestions.length - 1) {
                            buttonContainer.innerHTML += 
                                '<button class="next-btn" onclick="nextExamQuestion()">下一題</button>';
                        } else {
                            buttonContainer.innerHTML += 
                                '<button class="next-btn" onclick="finishExam()">完成考試</button>';
                        }
                    }
                }, 1000);
            }
            
            saveExamStats();
        }

        function skipQuestion() {
            if (examQuestions[currentQuestion]) {
                userAnswers.push({
                    questionIndex: currentQuestion,
                    selectedAnswer: -1,
                    correct: false,
                    question: examQuestions[currentQuestion]
                });
            }
            nextExamQuestion();
        }

        function nextExamQuestion() {
            currentQuestion++;
            window.selectedExamAnswer = undefined;
            displayExamQuestion();
        }

        function finishExam() {
            if (examTimer) {
                clearInterval(examTimer);
            }
            
            const endTime = Date.now();
            const timeSpent = Math.floor((endTime - examStartTime) / 1000);
            const correctCount = userAnswers.filter(a => a.correct).length;
            const totalCount = examQuestions.length;
            const score = totalCount > 0 ? Math.round((correctCount / totalCount) * 100) : 0;
            
            // 更新統計
            examStats.totalExams++;
            examStats.timeSpent += timeSpent;
            saveExamStats();
            
            // 顯示結果
            showExamResult(score, correctCount, totalCount, timeSpent);
        }

        function showExamResult(score, correct, total, timeSpent) {
            const resultContainer = document.getElementById('examResult');
            const questionContainer = document.getElementById('examQuestion');
            const progressContainer = document.getElementById('examProgress');
            
            if (questionContainer) questionContainer.style.display = 'none';
            if (progressContainer) progressContainer.style.display = 'none';
            if (resultContainer) resultContainer.style.display = 'block';
            
            let scoreClass = 'poor';
            let message = '需要加強練習';
            let emoji = '😰';
            
            if (score >= 90) {
                scoreClass = 'excellent';
                message = '表現優異！';
                emoji = '🎉';
            } else if (score >= 75) {
                scoreClass = 'good';
                message = '表現良好！';
                emoji = '😊';
            } else if (score >= 60) {
                scoreClass = 'fair';
                message = '尚可，再接再厲！';
                emoji = '😐';
            }
            
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            
            if (resultContainer) {
                resultContainer.innerHTML = `
                    <h2>${emoji} 考試結果</h2>
                    <div class="result-score ${scoreClass}">${score}分</div>
                    <p style="font-size: 1.2em; margin-bottom: 20px;">${message}</p>
                    
                    <div class="result-details">
                        <div class="result-item">
                            <h4>總題數</h4>
                            <div class="number">${total}</div>
                        </div>
                        <div class="result-item">
                            <h4>答對題數</h4>
                            <div class="number">${correct}</div>
                        </div>
                        <div class="result-item">
                            <h4>答錯題數</h4>
                            <div class="number">${total - correct}</div>
                        </div>
                        <div class="result-item">
                            <h4>使用時間</h4>
                            <div class="number">${minutes}:${seconds.toString().padStart(2, '0')}</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 25px;">
                        <button class="start-exam-btn" onclick="restartExam()">重新考試</button>
                        <button class="next-btn" onclick="showExamMode('review')" style="margin-left: 15px;">查看錯題</button>
                    </div>
                `;
            }
        }

        function restartExam() {
            const examResult = document.getElementById('examResult');
            const examSettings = document.querySelector('.exam-settings');
            
            if (examResult) examResult.style.display = 'none';
            if (examSettings) examSettings.style.display = 'flex';
            
            currentQuestion = 0;
            userAnswers = [];
            examQuestions = [];
        }

        function updateStatistics() {
            const container = document.getElementById('statisticsContent');
            if (!container) return;
            
            const accuracy = examStats.totalQuestions > 0 ? 
                Math.round((examStats.correctAnswers / examStats.totalQuestions) * 100) : 0;
            const avgTime = examStats.totalExams > 0 ? 
                Math.round(examStats.timeSpent / examStats.totalExams) : 0;
            
            container.innerHTML = `
                <div class="stat-card">
                    <h4>📊 總體統計</h4>
                    <div class="stat-number primary">${examStats.totalExams}</div>
                    <div class="stat-description">考試次數</div>
                </div>
                
                <div class="stat-card">
                    <h4>📝 答題統計</h4>
                    <div class="stat-number success">${examStats.totalQuestions}</div>
                    <div class="stat-description">累計答題數</div>
                </div>
                
                <div class="stat-card">
                    <h4>🎯 正確率</h4>
                    <div class="stat-number ${accuracy >= 80 ? 'success' : accuracy >= 60 ? 'warning' : 'danger'}">${accuracy}%</div>
                    <div class="stat-description">整體正確率</div>
                </div>
                
                <div class="stat-card">
                    <h4>⏱️ 平均時間</h4>
                    <div class="stat-number primary">${Math.floor(avgTime / 60)}:${(avgTime % 60).toString().padStart(2, '0')}</div>
                    <div class="stat-description">每次考試平均用時</div>
                </div>
                
                <div class="stat-card">
                    <h4>❌ 錯題數量</h4>
                    <div class="stat-number danger">${examStats.wrongQuestions.length}</div>
                    <div class="stat-description">需要復習的題目</div>
                </div>
                
                <div class="stat-card">
                    <h4>✅ 正確題數</h4>
                    <div class="stat-number success">${examStats.correctAnswers}</div>
                    <div class="stat-description">累計答對題數</div>
                </div>
            `;
        }

        function clearWrongAnswers() {
            if (confirm('確定要清空所有錯題記錄嗎？')) {
                examStats.wrongQuestions = [];
                saveExamStats();
                updateReviewContent();
            }
        }

        function updateReviewContent() {
            const container = document.getElementById('reviewContent');
            if (!container) return;
            
            if (examStats.wrongQuestions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #6c757d;">
                        <h3>🎉 太棒了！</h3>
                        <p>目前沒有錯題記錄，繼續保持！</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = examStats.wrongQuestions.map((item, index) => `
                <div class="review-question">
                    <h4>❌ 錯題 ${index + 1} - ${item.timestamp}</h4>
                    <div><strong>題目：</strong>${item.question}</div>
                    ${item.scenario ? `<div><strong>情境：</strong>${item.scenario}</div>` : ''}
                    <div class="your-answer"><strong>你的答案：</strong>${item.yourAnswer}</div>
                    <div class="correct-answer"><strong>正確答案：</strong>${item.correctAnswer}</div>
                    <div><strong>解析：</strong>${item.explanation}</div>
                </div>
            `).join('');
        }

        function saveExamStats() {
            try {
                localStorage.setItem('examStats', JSON.stringify(examStats));
            } catch (e) {
                console.error('無法保存統計資料:', e);
            }
        }

        // 事件監聽器
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                const activeElement = document.activeElement;
                if (activeElement && activeElement.tagName !== 'BUTTON') {
                    calculateDebitCredit();
                }
            }
        });

        // 頁面載入完成後初始化
        document.addEventListener('DOMContentLoaded', function() {
            updateReviewContent();
            updateStatistics();
        });

        // 備用初始化
        setTimeout(function() {
            if (typeof updateReviewContent === 'function') {
                updateReviewContent();
            }
            if (typeof updateStatistics === 'function') {
                updateStatistics();
            }
        }, 500);

    </script>
</body>
</html><!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>會計借貸判斷流程圖</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
            margin: 10px 0;
        }
        
        .rule-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 1.1em;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .rule-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .rule-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .rule-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .rule-table tr:hover {
            background-color: #e3f2fd;
            transform: scale(1.01);
            transition: all 0.3s ease;
        }
        
        .asset { background-color: #e8f5e8 !important; }
        .liability { background-color: #fff3e0 !important; }
        .equity { background-color: #f3e5f5 !important; }
        .revenue { background-color: #e1f5fe !important; }
        .expense { background-color: #ffebee !important; }
        
        .debit {
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            color: #c62828;
            font-weight: bold;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .credit {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            color: #2e7d32;
            font-weight: bold;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .flowchart {
            margin: 30px 0;
            text-align: center;
        }
        
        .step {
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 20px;
            margin: 15px;
            display: inline-block;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .step:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .step h3 {
            color: #667eea;
            margin: 0 0 10px 0;
            font-size: 1.3em;
        }
        
        .arrow {
            font-size: 2em;
            color: #667eea;
            margin: 0 20px;
        }
        
        .example-section {
            margin-top: 40px;
            padding: 25px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            color: white;
        }
        
        .example-section h2 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 2em;
        }
        
        .examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .example-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .example-card h3 {
            margin-top: 0;
            color: #fff;
            font-size: 1.3em;
        }
        
        .example-item {
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            border-left: 4px solid #fff;
        }
        
        .formula {
            background: #34495e;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.3em;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .interactive-demo {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #dee2e6;
        }
        
        .interactive-demo h2 {
            text-align: center;
            color: #495057;
            margin-bottom: 20px;
        }
        
        .demo-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .demo-controls select, .demo-controls button {
            padding: 10px 15px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1.1em;
            background: white;
        }
        
        .demo-controls button {
            background: #667eea;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .demo-controls button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .demo-result {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border: 2px solid #28a745;
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .exam-section {
            margin-top: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #dee2e6;
        }
        
        .exam-section h2 {
            text-align: center;
            color: #495057;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        .exam-tabs {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .exam-tab {
            padding: 12px 24px;
            border: none;
            background: #e9ecef;
            color: #495057;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 1em;
        }
        
        .exam-tab:hover {
            background: #dee2e6;
            transform: translateY(-2px);
        }
        
        .exam-tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .exam-mode {
            min-height: 400px;
        }
        
        .exam-controls, .exam-settings {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .exam-settings {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .setting-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .setting-group label {
            font-weight: bold;
            color: #495057;
        }
        
        .exam-controls select, .exam-settings select {
            padding: 10px 15px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            min-width: 150px;
        }
        
        .start-exam-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }
        
        .start-exam-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255,107,107,0.3);
        }
        
        .exam-progress {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #dc3545;
            background: #fff5f5;
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid #dc3545;
        }
        
        .question-counter {
            font-size: 1.2em;
            color: #495057;
            font-weight: bold;
        }
        
        .score-display {
            font-size: 1.2em;
            color: #28a745;
            font-weight: bold;
            background: #f8fff8;
            padding: 8px 15px;
            border-radius: 20px;
            border: 2px solid #28a745;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            border-radius: 5px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .question-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .question-text {
            font-size: 1.3em;
            color: #2c3e50;
            margin-bottom: 20px;
            line-height: 1.6;
            font-weight: bold;
        }
        
        .question-scenario {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #007bff;
            font-style: italic;
        }
        
        .answer-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .answer-option {
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: bold;
            background: white;
        }
        
        .answer-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-2px);
        }
        
        .answer-option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .answer-option.correct {
            border-color: #28a745;
            background: #28a745;
            color: white;
        }
        
        .answer-option.wrong {
            border-color: #dc3545;
            background: #dc3545;
            color: white;
        }
        
        .question-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .question-buttons button {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }
        
        .submit-btn {
            background: #28a745;
            color: white;
        }
        
        .submit-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .next-btn {
            background: #007bff;
            color: white;
        }
        
        .next-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        
        .skip-btn {
            background: #6c757d;
            color: white;
        }
        
        .skip-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        .explanation {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .explanation h4 {
            color: #856404;
            margin-top: 0;
            font-size: 1.2em;
        }
        
        .explanation p {
            color: #856404;
            margin-bottom: 0;
            line-height: 1.6;
        }
        
        .exam-result {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .result-score {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .result-score.excellent { color: #28a745; }
        .result-score.good { color: #007bff; }
        .result-score.fair { color: #ffc107; }
        .result-score.poor { color: #dc3545; }
        
        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .result-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .result-item h4 {
            margin: 0 0 10px 0;
            color: #495057;
        }
        
        .result-item .number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .review-content {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .review-question {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #dc3545;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .review-question h4 {
            color: #dc3545;
            margin-top: 0;
        }
        
        .your-answer, .correct-answer {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .your-answer {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .correct-answer {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .clear-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .clear-btn:hover {
            background: #c82333;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .statistics-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-card h4 {
            margin-top: 0;
            color: #495057;
            font-size: 1.3em;
        }
        
        .stat-number {
            font-size: 3em;
            font-weight: bold;
            margin: 15px 0;
        }
        
        .stat-number.primary { color: #667eea; }
        .stat-number.success { color: #28a745; }
        .stat-number.warning { color: #ffc107; }
        .stat-number.danger { color: #dc3545; }
        
        .stat-description {
            color: #6c757d;
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .rule-table {
                font-size: 0.9em;
            }
            
            .step {
                margin: 10px 5px;
                padding: 15px;
            }
            
            .arrow {
                display: block;
                margin: 10px 0;
            }
            
            .exam-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .exam-tab {
                width: 80%;
                text-align: center;
            }
            
            .exam-controls, .exam-settings {
                flex-direction: column;
                align-items: center;
            }
            
            .progress-header {
                flex-direction: column;
                text-align: center;
            }
            
            .answer-options {
                grid-template-columns: 1fr;
            }
            
            .result-details {
                grid-template-columns: 1fr;
            }
            
            .statistics-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 會計借貸判斷流程圖</h1>
            <p>一眼看懂：科目性質 + 增減 → 借貸方向</p>
        </div>
        
        <div class="formula">
            📌 核心概念：借貸只是記號，先看科目性質，再套用增減規則！
        </div>
        
        <table class="rule-table">
            <thead>
                <tr>
                    <th>科目種類</th>
                    <th>增加時</th>
                    <th>減少時</th>
                    <th>記憶口訣</th>
                </tr>
            </thead>
            <tbody>
                <tr class="asset">
                    <td><strong>資產 (Asset)</strong><br>現金、存貨、設備等</td>
                    <td><span class="debit">借 (D)</span></td>
                    <td><span class="credit">貸 (C)</span></td>
                    <td>資產多借少貸</td>
                </tr>
                <tr class="liability">
                    <td><strong>負債 (Liability)</strong><br>應付帳款、借款等</td>
                    <td><span class="credit">貸 (C)</span></td>
                    <td><span class="debit">借 (D)</span></td>
                    <td>負債多貸少借</td>
                </tr>
                <tr class="equity">
                    <td><strong>權益 (Equity)</strong><br>資本、保留盈餘等</td>
                    <td><span class="credit">貸 (C)</span></td>
                    <td><span class="debit">借 (D)</span></td>
                    <td>權益多貸少借</td>
                </tr>
                <tr class="revenue">
                    <td><strong>收入 (Revenue)</strong><br>銷貨收入、利息收入等</td>
                    <td><span class="credit">貸 (C)</span></td>
                    <td><span class="debit">借 (D)</span></td>
                    <td>收入多貸少借</td>
                </tr>
                <tr class="expense">
                    <td><strong>費用 (Expense)</strong><br>薪資費用、租金費用等</td>
                    <td><span class="debit">借 (D)</span></td>
                    <td><span class="credit">貸 (C)</span></td>
                    <td>費用多借少貸</td>
                </tr>
            </tbody>
        </table>
        
        <div class="flowchart">
            <h2>🔄 三步驟判斷流程</h2>
            <div class="step">
                <h3>步驟 1</h3>
                <p>識別科目性質<br>（資產/負債/權益/收入/費用）</p>
            </div>
            <span class="arrow">➡️</span>
            <div class="step">
                <h3>步驟 2</h3>
                <p>判斷是增加還是減少</p>
            </div>
            <span class="arrow">➡️</span>
            <div class="step">
                <h3>步驟 3</h3>
                <p>套用借貸規則<br>查表得出答案</p>
            </div>
        </div>
        
        <div class="interactive-demo">
            <h2>🎮 互動練習</h2>
            <div class="demo-controls">
                <select id="accountType">
                    <option value="">選擇科目類型</option>
                    <option value="asset">資產</option>
                    <option value="liability">負債</option>
                    <option value="equity">權益</option>
                    <option value="revenue">收入</option>
                    <option value="expense">費用</option>
                </select>
                
                <select id="change">
                    <option value="">選擇變化</option>
                    <option value="increase">增加</option>
                    <option value="decrease">減少</option>
                </select>
                
                <button onclick="calculateDebitCredit()">計算借貸</button>
            </div>
            
            <div id="demoResult" class="demo-result" style="display: none;"></div>
        </div>

        <div class="exam-section">
            <h2>📝 學習考試</h2>
            <div class="exam-tabs">
                <button class="exam-tab active" onclick="showExamMode('practice')">練習模式</button>
                <button class="exam-tab" onclick="showExamMode('test')">正式考試</button>
                <button class="exam-tab" onclick="showExamMode('review')">錯題回顧</button>
                <button class="exam-tab" onclick="showStatistics()">學習統計</button>
            </div>
            
            <!-- 練習模式 -->
            <div id="practiceMode" class="exam-mode active">
                <div class="exam-controls">
                    <select id="practiceLevel">
                        <option value="beginner">初級（基本科目）</option>
                        <option value="intermediate">中級（混合科目）</option>
                        <option value="advanced">高級（實務案例）</option>
                    </select>
                    <button onclick="startPractice()">開始練習</button>
                </div>
                <div id="practiceQuestion" class="question-container" style="display: none;"></div>
            </div>
            
            <!-- 正式考試模式 -->
            <div id="testMode" class="exam-mode" style="display: none;">
                <div class="exam-settings">
                    <div class="setting-group">
                        <label>考試時間：</label>
                        <select id="testDuration">
                            <option value="300">5分鐘（快速測驗）</option>
                            <option value="600">10分鐘（標準測驗）</option>
                            <option value="1200">20分鐘（完整測驗）</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label>題目數量：</label>
                        <select id="questionCount">
                            <option value="10">10題</option>
                            <option value="15">15題</option>
                            <option value="20">20題</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label>難度等級：</label>
                        <select id="testLevel">
                            <option value="mixed">混合難度</option>
                            <option value="beginner">初級</option>
                            <option value="intermediate">中級</option>
                            <option value="advanced">高級</option>
                        </select>
                    </div>
                    <button onclick="startExam()" class="start-exam-btn">開始考試</button>
                </div>
                
                <div id="examProgress" class="exam-progress" style="display: none;">
                    <div class="progress-header">
                        <div class="timer" id="examTimer">00:00</div>
                        <div class="question-counter" id="questionCounter">第 1 題，共 10 題</div>
                        <div class="score-display" id="currentScore">目前得分: 0</div>
                    </div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                </div>
                
                <div id="examQuestion" class="question-container"></div>
                <div id="examResult" class="exam-result" style="display: none;"></div>
            </div>
            
            <!-- 錯題回顧模式 -->
            <div id="reviewMode" class="exam-mode" style="display: none;">
                <div class="review-header">
                    <h3>📚 錯題回顧與分析</h3>
                    <button onclick="clearWrongAnswers()" class="clear-btn">清空錯題記錄</button>
                </div>
                <div id="reviewContent" class="review-content"></div>
            </div>
            
            <!-- 學習統計 -->
            <div id="statisticsMode" class="exam-mode" style="display: none;">
                <h3>📊 學習統計分析</h3>
                <div i